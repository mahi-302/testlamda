import os
import boto3
import json
AMI = os.environ['ami']
INSTANCE_TYPE = os.environ['instance_type']
KEY_NAME = os.environ['key_name']
SUBNET_ID = os.environ['sunnet_id']
REGION = os.environ['region']
ec2 = boto3.client('ec2', region_name=REGION)
init_script = """"#!/bin/bash
 sudo apt-get update -y
 sudo apt-get upgrade -y
 sudo apt-get install apache2 -y"""
def lambda_handler(event, context):
 instance = ec2.run_instances(ImageId=AMI,InstanceType=INSTANCE_TYPE,KeyName=KEY_NAME,SubnetId=SUBNET_ID,MaxCount=1,MinCount=1,UserData=init_script)
 instance_id = instance['Instances'][0]['InstanceId']
 return instance_id